// Generated by CoffeeScript 1.7.1
(function() {
  var controller, name, socket;

  controller = new Controller();

  name = localStorage["name"];

  socket = io.connect("192.168.1.103:8080");

  socket.on("connect", function() {
    socket.emit("addUser", name);
    $("#connecting").hide();
    return $("#container").show();
  });

  socket.on("updateChat", function(username, data, color, connected, connectedFirst) {
    if (username === null) {
      $("#conversation").append("<span class='" + color + "'>" + data + "</span><br>");
      if (connected === true) {
        timer.startTimer();
      }
      if (connectedFirst === true) {
        startLoading();
      }
      if (connected === false) {
        controller.reset();
      }
    } else {
      $("#conversation").append("<span class='blue'><b class='" + color + "'>" + username + ":</b> " + data + "</span><br>");
    }
    return $("#conversation")[0].scrollTop = $("#conversation")[0].scrollHeight;
  });

  $("#data-send").click(function() {
    var message;
    message = $("#data").val();
    $("#data").val("");
    socket.emit("sendChat", message);
    return $("#data").focus();
  });

  socket.on("updateGame", function(parentLocation, location) {
    var tempArr;
    parentLocation = "." + (parentLocation.split(" ").join("."));
    tempArr = location.split(" ");
    location = $("" + parentLocation + " ." + (tempArr.slice(0, tempArr.length - 1).join(".")));
    controller.autoClicked = true;
    return location.focus().click();
  });

  socket.on("setPlayer", function(num) {
    var imageSrc;
    controller.playerNum = num;
    imageSrc = num === 1 ? "assets/images/smallX.png" : "assets/images/smallO.png";
    $("#player").html("<span>You are <img src='" + imageSrc + "'></span>");
    return $("#player").show();
  });

  socket.on("connect_failed", function() {
    console.log("connect_failed");
    $("#connecting").hide();
    $("#container").hide();
    return $("#connect-failed-msg").show();
  });

  $("#data").keypress(function(e) {
    if (e.which === 13) {
      $(this).blur();
      return $("#data-send").focus().click();
    }
  });

  $("a").click(function() {
    return socket.disconnect();
  });

}).call(this);
